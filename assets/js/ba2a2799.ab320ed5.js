"use strict";(self.webpackChunkmetro_website=self.webpackChunkmetro_website||[]).push([[122],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>m,MDXProvider:()=>c,mdx:()=>f,useMDXComponents:()=>p,withMDXComponents:()=>s});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},r.apply(this,arguments)}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var m=a.createContext({}),s=function(e){return function(n){var t=p(n.components);return a.createElement(e,r({},n,{components:t}))}},p=function(e){var n=a.useContext(m),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(m.Provider,{value:n},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},x=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,m=d(e,["components","mdxType","originalType","parentName"]),s=p(t),c=o,u=s["".concat(i,".").concat(c)]||s[c]||h[c]||r;return t?a.createElement(u,l(l({ref:n},m),{},{components:t})):a.createElement(u,l({ref:n},m))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=x;var l={};for(var d in n)hasOwnProperty.call(n,d)&&(l[d]=n[d]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var m=2;m<r;m++)i[m]=t[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}x.displayName="MDXCreateElement"},15389:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>m,toc:()=>p});var a=t(87462),o=t(63366),r=(t(67294),t(3905)),i=["components"],l={id:"configuration",title:"Configuring Metro"},d=void 0,m={unversionedId:"configuration",id:"configuration",title:"Configuring Metro",description:"A Metro config can be created in these three ways (ordered by priority):",source:"@site/../docs/Configuration.md",sourceDirName:".",slug:"/configuration",permalink:"/docs/configuration",draft:!1,editUrl:"https://github.com/facebook/metro/edit/main/docs/../docs/Configuration.md",tags:[],version:"current",lastUpdatedAt:1727347369,formattedLastUpdatedAt:"Sep 26, 2024",frontMatter:{id:"configuration",title:"Configuring Metro"},sidebar:"docs",previous:{title:"Module API",permalink:"/docs/module-api"},next:{title:"Metro CLI Options",permalink:"/docs/cli"}},s={},p=[{value:"Configuration Structure",id:"configuration-structure",level:2},{value:"General Options",id:"general-options",level:3},{value:"<code>cacheStores</code>",id:"cachestores",level:4},{value:"<code>cacheVersion</code>",id:"cacheversion",level:4},{value:"<code>projectRoot</code>",id:"projectroot",level:4},{value:"<code>watchFolders</code>",id:"watchfolders",level:4},{value:"<code>transformerPath</code>",id:"transformerpath",level:4},{value:"<code>reporter</code>",id:"reporter",level:4},{value:"<code>resetCache</code>",id:"resetcache",level:4},{value:"<code>stickyWorkers</code>",id:"stickyworkers",level:4},{value:"<code>maxWorkers</code>",id:"maxworkers",level:4},{value:"<code>fileMapCacheDirectory</code>",id:"filemapcachedirectory",level:4},{value:'<code>hasteMapCacheDirectory</code> <div class="label deprecated">Deprecated</div>',id:"hastemapcachedirectory-deprecated",level:4},{value:"<code>unstable_perfLoggerFactory</code>",id:"unstable_perfloggerfactory",level:4},{value:"Resolver Options",id:"resolver-options",level:3},{value:"<code>assetExts</code>",id:"assetexts",level:4},{value:"<code>sourceExts</code>",id:"sourceexts",level:4},{value:"<code>resolverMainFields</code>",id:"resolvermainfields",level:4},{value:"<code>disableHierarchicalLookup</code>",id:"disablehierarchicallookup",level:4},{value:"<code>emptyModulePath</code>",id:"emptymodulepath",level:4},{value:"<code>enableGlobalPackages</code>",id:"enableglobalpackages",level:4},{value:"<code>extraNodeModules</code>",id:"extranodemodules",level:4},{value:"<code>nodeModulesPaths</code>",id:"nodemodulespaths",level:4},{value:"<code>resolveRequest</code>",id:"resolverequest",level:4},{value:"<code>useWatchman</code>",id:"usewatchman",level:4},{value:"<code>blockList</code>",id:"blocklist",level:4},{value:"<code>hasteImplModulePath</code>",id:"hasteimplmodulepath",level:4},{value:"<code>platforms</code>",id:"platforms",level:4},{value:"<code>requireCycleIgnorePatterns</code>",id:"requirecycleignorepatterns",level:4},{value:'<code>unstable_conditionNames</code> <div class="label experimental">Experimental</div>',id:"unstable_conditionnames-experimental",level:4},{value:'<code>unstable_conditionsByPlatform</code> <div class="label experimental">Experimental</div>',id:"unstable_conditionsbyplatform-experimental",level:4},{value:'<code>unstable_enablePackageExports</code> <div class="label experimental">Experimental</div>',id:"unstable_enablepackageexports-experimental",level:4},{value:"Transformer Options",id:"transformer-options",level:3},{value:'<code>asyncRequireModulePath</code> <div class="label deprecated">Deprecated</div>',id:"asyncrequiremodulepath-deprecated",level:4},{value:"<code>dynamicDepsInPackages</code>",id:"dynamicdepsinpackages",level:4},{value:"<code>getTransformOptions</code>",id:"gettransformoptions",level:4},{value:"<code>minifierPath</code>",id:"minifierpath",level:4},{value:"<code>minifierConfig</code>",id:"minifierconfig",level:4},{value:"<code>optimizationSizeLimit</code>",id:"optimizationsizelimit",level:4},{value:"React Native Only",id:"react-native-only",level:4},{value:"<code>assetPlugins</code>",id:"assetplugins",level:4},{value:"<code>assetRegistryPath</code>",id:"assetregistrypath",level:4},{value:"Babel-specific transformer options",id:"babel-specific-transformer-options",level:3},{value:"<code>babelTransformerPath</code>",id:"babeltransformerpath",level:4},{value:"<code>enableBabelRCLookup</code>",id:"enablebabelrclookup",level:4},{value:"<code>enableBabelRuntime</code>",id:"enablebabelruntime",level:4},{value:"<code>hermesParser</code>",id:"hermesparser",level:4},{value:"Serializer Options",id:"serializer-options",level:3},{value:"<code>getRunModuleStatement</code>",id:"getrunmodulestatement",level:4},{value:"<code>createModuleIdFactory</code>",id:"createmoduleidfactory",level:4},{value:"<code>getPolyfills</code>",id:"getpolyfills",level:4},{value:"<code>getModulesRunBeforeMainModule</code>",id:"getmodulesrunbeforemainmodule",level:4},{value:"<code>processModuleFilter</code>",id:"processmodulefilter",level:4},{value:"<code>isThirdPartyModule</code>",id:"isthirdpartymodule",level:4},{value:"Server Options",id:"server-options",level:3},{value:"<code>port</code>",id:"port",level:4},{value:"<code>useGlobalHotkey</code>",id:"useglobalhotkey",level:4},{value:'<code>enhanceMiddleware</code> <div class="label deprecated">Deprecated</div>',id:"enhancemiddleware-deprecated",level:4},{value:"<code>rewriteRequestUrl</code>",id:"rewriterequesturl",level:4},{value:"<code>forwardClientLogs</code>",id:"forwardclientlogs",level:4},{value:"Watcher Options",id:"watcher-options",level:3},{value:"<code>additionalExts</code>",id:"additionalexts",level:4},{value:"<code>healthCheck.enabled</code>",id:"healthcheckenabled",level:4},{value:"<code>healthCheck.filePrefix</code>",id:"healthcheckfileprefix",level:4},{value:"<code>healthCheck.interval</code>",id:"healthcheckinterval",level:4},{value:"<code>healthCheck.timeout</code>",id:"healthchecktimeout",level:4},{value:"<code>watchman.deferStates</code>",id:"watchmandeferstates",level:4},{value:"Merging Configurations",id:"merging-configurations",level:2},{value:"Merging Example",id:"merging-example",level:4}],c={toc:p},u="wrapper";function h(e){var n=e.components,t=(0,o.Z)(e,i);return(0,r.mdx)(u,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("p",null,"A Metro config can be created in these three ways (ordered by priority):"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("inlineCode",{parentName:"li"},"metro.config.js")),(0,r.mdx)("li",{parentName:"ol"},(0,r.mdx)("inlineCode",{parentName:"li"},"metro.config.json")),(0,r.mdx)("li",{parentName:"ol"},"The ",(0,r.mdx)("inlineCode",{parentName:"li"},"metro")," field in ",(0,r.mdx)("inlineCode",{parentName:"li"},"package.json"))),(0,r.mdx)("p",null,"You can also give a custom file to the configuration by specifying ",(0,r.mdx)("inlineCode",{parentName:"p"},"--config <path/to/config>")," when calling the CLI."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"When Metro is started via the React Native CLI, some defaults are different from those mentioned below.\nSee the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/react-native/blob/main/packages/community-cli-plugin/src/utils/loadMetroConfig.js"},"React Native repository")," for details.")),(0,r.mdx)("h2",{id:"configuration-structure"},"Configuration Structure"),(0,r.mdx)("p",null,"The configuration is based on ",(0,r.mdx)("a",{parentName:"p",href:"/docs/concepts"},"our concepts"),", which means that for every module we have a separate config option. A common configuration structure in Metro looks like this:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  /* general options */\n\n  resolver: {\n    /* resolver options */\n  },\n  transformer: {\n    /* transformer options */\n  },\n  serializer: {\n    /* serializer options */\n  },\n  server: {\n    /* server options */\n  },\n  watcher: {\n    /* watcher options */\n    watchman: {\n      /* Watchman-specific options */\n    }\n  }\n};\n")),(0,r.mdx)("h3",{id:"general-options"},"General Options"),(0,r.mdx)("h4",{id:"cachestores"},(0,r.mdx)("inlineCode",{parentName:"h4"},"cacheStores")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"CacheStores")," (see details below)"),(0,r.mdx)("p",null,"A list of storage adapters for Metro's ",(0,r.mdx)("a",{parentName:"p",href:"/docs/caching"},"transformer cache"),". This can be any combination of ",(0,r.mdx)("a",{parentName:"p",href:"/docs/caching#built-in-cache-stores"},"built-in cache stores")," and ",(0,r.mdx)("a",{parentName:"p",href:"/docs/caching#custom-cache-stores"},"custom cache stores"),". Defaults to using a temporary directory on disk as the only cache store."),(0,r.mdx)("p",null,"When Metro needs to transform a module, it first computes a machine-independent cache key for that file, and uses it to try to read from each of the stores in order. Once Metro has obtained the output of the transformer (whether already cached or not), it writes the transform result to ",(0,r.mdx)("em",{parentName:"p"},"all")," of the stores that returned ",(0,r.mdx)("inlineCode",{parentName:"p"},"null")," (a cache miss) for that key."),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-flow"},"type CacheStores =\n  | Array<CacheStore<Buffer | JsonSerializable>>\n  | ((MetroCache) => Array<\n      CacheStore<Buffer | JsonSerializable>\n    >);\n\n// The exports of 'metro-cache'\ntype MetroCache = {\n  FileStore,\n  AutoCleanFileStore,\n  HttpStore,\n  HttpGetStore,\n  ...\n};\n\ntype JsonSerializable = /* Any JSON-serializable value */;\n")),(0,r.mdx)("h4",{id:"cacheversion"},(0,r.mdx)("inlineCode",{parentName:"h4"},"cacheVersion")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"An arbitrary string appended to all cache keys in the project before they are hashed. There is generally no need to set this explicitly, as Metro will automatically derive the correct cache keys from your project config and the contents of source files."),(0,r.mdx)("h4",{id:"projectroot"},(0,r.mdx)("inlineCode",{parentName:"h4"},"projectRoot")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"The root folder of your project. If your project depends on any files outside this root, their containing directories must be listed in ",(0,r.mdx)("a",{parentName:"p",href:"#watchfolders"},(0,r.mdx)("inlineCode",{parentName:"a"},"watchFolders")),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"If your Metro project is developed in a monorepo and includes files from multiple logical packages, you'll generally want to set ",(0,r.mdx)("inlineCode",{parentName:"p"},"projectRoot")," to the root of your repository, or at least high enough in the hierarchy that all relevant files are reachable without separately configuring ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders"),".")),(0,r.mdx)("h4",{id:"watchfolders"},(0,r.mdx)("inlineCode",{parentName:"h4"},"watchFolders")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"A list of directories outside of ",(0,r.mdx)("a",{parentName:"p",href:"#projectroot"},(0,r.mdx)("inlineCode",{parentName:"a"},"projectRoot"))," that can contain source files for the project."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"Despite the naming of this option, it isn't related solely to file watching. Even in an offline build (for example, in CI), all files must be visible to Metro through the combination of ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"projectRoot"),".")),(0,r.mdx)("admonition",{type:"info"},(0,r.mdx)("p",{parentName:"admonition"},"Note that, as with any other file Metro needs to resolve, targets of any symlinks within your ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders")," ",(0,r.mdx)("em",{parentName:"p"},"must also be within ",(0,r.mdx)("inlineCode",{parentName:"em"},"watchFolders"))," and not otherwise excluded."),(0,r.mdx)("p",{parentName:"admonition"},"If you have a Metro project within a workspace, such as a ",(0,r.mdx)("a",{parentName:"p",href:"https://classic.yarnpkg.com/lang/en/docs/workspaces/"},"Yarn workspace")," (a subdirectory of a Yarn workspace root), it's likely you'll want to include your workspace ",(0,r.mdx)("em",{parentName:"p"},"root")," path in your configured ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders")," so that Metro can resolve other workspaces or hoisted ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules"),". Similarly, to use ",(0,r.mdx)("a",{parentName:"p",href:"https://classic.yarnpkg.com/lang/en/docs/cli/link/"},"linked packages"),", you'll need to list those package source locations (or a containing directory) in ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders"),".")),(0,r.mdx)("h4",{id:"transformerpath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"transformerPath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"The absolute path of a module (or a package name resolvable from the ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro")," package) that implements a transformer."),(0,r.mdx)("p",null,"See the implementation of Metro's default transformer (",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro-transform-worker/src/index.js"},(0,r.mdx)("inlineCode",{parentName:"a"},"metro-transform-worker")),") for more information about the transformer interface."),(0,r.mdx)("h4",{id:"reporter"},(0,r.mdx)("inlineCode",{parentName:"h4"},"reporter")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"{update: (event: ReportableEvent) => void}")),(0,r.mdx)("p",null,"Used to report the status of the bundler during the bundling process. The default implementation prints most events to the terminal."),(0,r.mdx)("p",null,"See also the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro/src/lib/reporting.js"},"definition of ",(0,r.mdx)("inlineCode",{parentName:"a"},"ReportableEvent"))," in Metro's source code."),(0,r.mdx)("h4",{id:"resetcache"},(0,r.mdx)("inlineCode",{parentName:"h4"},"resetCache")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"If ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),", Metro will reset the transformer cache (see ",(0,r.mdx)("a",{parentName:"p",href:"#cachestores"},(0,r.mdx)("inlineCode",{parentName:"a"},"cacheStores")),") and the file map cache (see ",(0,r.mdx)("a",{parentName:"p",href:"#filemapcachedirectory"},(0,r.mdx)("inlineCode",{parentName:"a"},"fileMapCacheDirectory")),") on startup."),(0,r.mdx)("h4",{id:"stickyworkers"},(0,r.mdx)("inlineCode",{parentName:"h4"},"stickyWorkers")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"If ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),", Metro will use a stable mapping from files to transformer workers, so the same file is always transformed by the same worker. This can improve initial build performance if the transformer is expensive to initialize, but can slow down concurrent builds with different configurations (e.g. multiple React Native apps connected to one Metro server). Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),"."),(0,r.mdx)("h4",{id:"maxworkers"},(0,r.mdx)("inlineCode",{parentName:"h4"},"maxWorkers")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"number")),(0,r.mdx)("p",null,"The number of workers to use for parallel processing in Metro. Defaults to approximately half of the number of cores available on the machine, as reported by ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/api/os.html#oscpus"},(0,r.mdx)("inlineCode",{parentName:"a"},"os.cpus()")),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("ol",{parentName:"admonition"},(0,r.mdx)("li",{parentName:"ol"},"Values exceeding the number of available cores have no effect."),(0,r.mdx)("li",{parentName:"ol"},"If ",(0,r.mdx)("inlineCode",{parentName:"li"},"maxWorkers")," is set to 1 or lower, worker code will run in the main Metro process instead of concurrently."),(0,r.mdx)("li",{parentName:"ol"},"Metro has two separate worker pools - one for transformation and one for building the file map. Each pool has its worker count set to ",(0,r.mdx)("inlineCode",{parentName:"li"},"maxWorkers")," independently."))),(0,r.mdx)("h4",{id:"filemapcachedirectory"},(0,r.mdx)("inlineCode",{parentName:"h4"},"fileMapCacheDirectory")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"The path to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro-file-map")," cache directory, defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"os.tmpdir()"),"."),(0,r.mdx)("h4",{id:"hastemapcachedirectory-deprecated"},(0,r.mdx)("inlineCode",{parentName:"h4"},"hasteMapCacheDirectory")," ",(0,r.mdx)("div",{class:"label deprecated"},"Deprecated")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"Alias of ",(0,r.mdx)("a",{parentName:"p",href:"#filemapcachedirectory"},(0,r.mdx)("inlineCode",{parentName:"a"},"fileMapCacheDirectory"))),(0,r.mdx)("h4",{id:"unstable_perfloggerfactory"},(0,r.mdx)("inlineCode",{parentName:"h4"},"unstable_perfLoggerFactory")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"PerfLoggerFactory")),(0,r.mdx)("p",null,"A logger factory function that can be used to get insights about Metro performance timings and metadata for events including startup, bundling and HMR. Metro expects ",(0,r.mdx)("inlineCode",{parentName:"p"},"unstable_perfLoggerFactory")," to have the following signature:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-flow"},"function unstable_perfLoggerFactory(\n  type: string,\n  opts: $ReadOnly<{\n    key?: string\n  }>,\n): RootPerfLogger {\n  // ...\n};\n")),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"type"))," Type of event being logged, e.g. ",(0,r.mdx)("inlineCode",{parentName:"li"},"'STARTUP'"),", ",(0,r.mdx)("inlineCode",{parentName:"li"},"'BUNDLING_REQUEST'"),", ",(0,r.mdx)("inlineCode",{parentName:"li"},"'HMR'"),". See type definition of ",(0,r.mdx)("a",{parentName:"li",href:"https://github.com/facebook/metro/blob/main/packages/metro-config/src/configTypes.flow.js"},"PerfLoggerFactory")," for a full list of event types."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"opts")),(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"key")),": An opaque identifier to distinguish between instances of an event type (e.g. multiple, possibly concurrent, HMR requests).")))),(0,r.mdx)("p",null,(0,r.mdx)("inlineCode",{parentName:"p"},"unstable_perfLoggerFactory")," should return an object implementing the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro-config/src/configTypes.flow.js"},"RootPerfLogger")," interface. For example, a factory function returning a no-op RootPerfLogger could be implemented as follows:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"const unstable_perfLoggerFactory = (type, factoryOpts) => {\n  const getLogger = subSpanLabel => {\n    const logger = {\n      start(opts) {},\n      end(status, opts) {},\n      subSpan(label) {\n        return getLogger(`${subSpanLabel ?? ''}/${label}`);\n      },\n      point(name, opts) {},\n      annotate(annotations) {},\n    };\n    return logger;\n  };\n\n  return getLogger();\n};\n")),(0,r.mdx)("hr",null),(0,r.mdx)("h3",{id:"resolver-options"},"Resolver Options"),(0,r.mdx)("h4",{id:"assetexts"},(0,r.mdx)("inlineCode",{parentName:"h4"},"assetExts")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"The list of asset file extensions to include in the bundle. For example, including ",(0,r.mdx)("inlineCode",{parentName:"p"},"'ttf'")," allows Metro bundles to reference ",(0,r.mdx)("inlineCode",{parentName:"p"},".ttf")," files. This is used primarily to enable React Native's ",(0,r.mdx)("a",{parentName:"p",href:"https://reactnative.dev/docs/images"},"image asset support"),". The default list includes many common image, video and audio file extensions. See ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro-config/src/defaults/defaults.js#L16"},"Metro's source code")," for the full list."),(0,r.mdx)("h4",{id:"sourceexts"},(0,r.mdx)("inlineCode",{parentName:"h4"},"sourceExts")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"The list of source file extensions to include in the bundle. For example, including ",(0,r.mdx)("inlineCode",{parentName:"p"},"'ts'")," allows Metro to include ",(0,r.mdx)("inlineCode",{parentName:"p"},".ts")," files in the bundle."),(0,r.mdx)("p",null,"The order of these extensions defines the order to match files on disk. For more information, see ",(0,r.mdx)("a",{parentName:"p",href:"https://metrobundler.dev/docs/resolution"},"Module Resolution"),"."),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['js', 'jsx', 'json', 'ts', 'tsx']"),"."),(0,r.mdx)("h4",{id:"resolvermainfields"},(0,r.mdx)("inlineCode",{parentName:"h4"},"resolverMainFields")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"The list of fields in ",(0,r.mdx)("inlineCode",{parentName:"p"},"package.json")," that Metro will treat as describing a package's entry points. The default is ",(0,r.mdx)("inlineCode",{parentName:"p"},"['browser', 'main']"),", so the resolver will use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"browser")," field if it exists and ",(0,r.mdx)("inlineCode",{parentName:"p"},"main")," otherwise."),(0,r.mdx)("p",null,"Metro's default resolver processes each of these fields according to the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/defunctzombie/package-browser-field-spec"},(0,r.mdx)("inlineCode",{parentName:"a"},"browser")," field spec"),", including the ability to ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/defunctzombie/package-browser-field-spec#replace-specific-files---advanced"},"replace")," and ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/defunctzombie/package-browser-field-spec#ignore-a-module"},"ignore")," specific files. For more information, see ",(0,r.mdx)("a",{parentName:"p",href:"https://metrobundler.dev/docs/resolution"},"Module Resolution"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"When using React Native, ",(0,r.mdx)("inlineCode",{parentName:"p"},"resolverMainFields")," defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['react-native', 'browser', 'main']"),".")),(0,r.mdx)("h4",{id:"disablehierarchicallookup"},(0,r.mdx)("inlineCode",{parentName:"h4"},"disableHierarchicalLookup")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Whether to disable ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders"},"looking up modules in ",(0,r.mdx)("inlineCode",{parentName:"a"},"node_modules")," folders"),". This only affects the default search through the directory tree, not other Metro options like ",(0,r.mdx)("inlineCode",{parentName:"p"},"extraNodeModules")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"nodeModulesPaths"),". Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"."),(0,r.mdx)("h4",{id:"emptymodulepath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"emptyModulePath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,'What module to use as the canonical "empty" module when one is needed. Defaults to using the one included in ',(0,r.mdx)("inlineCode",{parentName:"p"},"metro-runtime"),". You only need to change this if Metro is installed outside of your project."),(0,r.mdx)("h4",{id:"enableglobalpackages"},(0,r.mdx)("inlineCode",{parentName:"h4"},"enableGlobalPackages")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean"),"."),(0,r.mdx)("p",null,"Whether to automatically resolve references to first-party packages (e.g. workspaces) in your project. Any ",(0,r.mdx)("inlineCode",{parentName:"p"},"package.json")," file with a valid ",(0,r.mdx)("inlineCode",{parentName:"p"},"name")," property within ",(0,r.mdx)("inlineCode",{parentName:"p"},"projectRoot")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchFolders")," (but outside of ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules"),") counts as a package for this purpose. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"."),(0,r.mdx)("h4",{id:"extranodemodules"},(0,r.mdx)("inlineCode",{parentName:"h4"},"extraNodeModules")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"{[string]: string}")),(0,r.mdx)("p",null,"A mapping of package names to directories that is consulted after the standard lookup through ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules")," as well as any ",(0,r.mdx)("a",{parentName:"p",href:"#nodemodulespaths"},(0,r.mdx)("inlineCode",{parentName:"a"},"nodeModulesPaths")),". For more information, see ",(0,r.mdx)("a",{parentName:"p",href:"https://metrobundler.dev/docs/resolution"},"Module Resolution"),"."),(0,r.mdx)("h4",{id:"nodemodulespaths"},(0,r.mdx)("inlineCode",{parentName:"h4"},"nodeModulesPaths")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"A list of paths to check for modules after looking through all ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules")," directories. This is useful if third-party dependencies are installed in a different location outside of the direct path of source files. For more information, see ",(0,r.mdx)("a",{parentName:"p",href:"https://metrobundler.dev/docs/resolution"},"Module Resolution"),"."),(0,r.mdx)("h4",{id:"resolverequest"},(0,r.mdx)("inlineCode",{parentName:"h4"},"resolveRequest")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("a",{parentName:"p",href:"/docs/resolution#resolverequest-customresolver"},(0,r.mdx)("inlineCode",{parentName:"a"},"?CustomResolver"))),(0,r.mdx)("p",null,"An optional function used to override the default resolution algorithm. This is particularly useful for cases where aliases or custom protocols are used. For example:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},"resolveRequest: (context, moduleName, platform) => {\n  if (moduleName.startsWith('my-custom-resolver:')) {\n    // Logic to resolve the module name to a file path...\n    // NOTE: Throw an error if there is no resolution.\n    return {\n      filePath: 'path/to/file',\n      type: 'sourceFile',\n    };\n  }\n  // Optionally, chain to the standard Metro resolver.\n  return context.resolveRequest(context, moduleName, platform);\n}\n")),(0,r.mdx)("p",null,"For more information on customizing the resolver, see ",(0,r.mdx)("a",{parentName:"p",href:"https://metrobundler.dev/docs/resolution"},"Module Resolution"),"."),(0,r.mdx)("h4",{id:"usewatchman"},(0,r.mdx)("inlineCode",{parentName:"h4"},"useWatchman")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"If set to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),", prevents Metro from using Watchman (even if it's installed)."),(0,r.mdx)("h4",{id:"blocklist"},(0,r.mdx)("inlineCode",{parentName:"h4"},"blockList")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"RegExp")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<RegExp>")),(0,r.mdx)("p",null,"A regular expression (or list of regular expressions) defining which paths to exclude from Metro's file map. Files whose absolute paths match these patterns are effectively hidden from Metro and cannot be resolved or imported in the current project."),(0,r.mdx)("h4",{id:"hasteimplmodulepath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"hasteImplModulePath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"?string")),(0,r.mdx)("p",null,"The path to the Haste implementation for the current project. Haste is an opt-in mechanism for importing modules by their globally-unique name anywhere in the project, e.g. ",(0,r.mdx)("inlineCode",{parentName:"p"},"import Foo from 'Foo'"),"."),(0,r.mdx)("p",null,"Metro expects this module to have the following signature:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-flow"},"module.exports = {\n  getHasteName(filePath: string): ?string {\n    // ...\n  },\n};\n")),(0,r.mdx)("p",null,(0,r.mdx)("inlineCode",{parentName:"p"},"getHasteName")," should return a short, globally unique name for the module whose path is ",(0,r.mdx)("inlineCode",{parentName:"p"},"filePath"),", or ",(0,r.mdx)("inlineCode",{parentName:"p"},"null")," if the module should not be accessible via Haste."),(0,r.mdx)("h4",{id:"platforms"},(0,r.mdx)("inlineCode",{parentName:"h4"},"platforms")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"Additional platforms to resolve. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['ios', 'android', 'windows', 'web']"),"."),(0,r.mdx)("p",null,"For more information, see ",(0,r.mdx)("a",{parentName:"p",href:"/docs/resolution"},"Module Resolution")," and ",(0,r.mdx)("a",{parentName:"p",href:"https://reactnative.dev/docs/platform-specific-code#platform-specific-extensions"},"React Native's documentation for platform-specific extensions"),"."),(0,r.mdx)("h4",{id:"requirecycleignorepatterns"},(0,r.mdx)("inlineCode",{parentName:"h4"},"requireCycleIgnorePatterns")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<RegExp>")),(0,r.mdx)("p",null,"In development mode, suppress require cycle warnings for any cycle involving a module that matches any of these expressions. This is useful for third-party code and first-party expected cycles."),(0,r.mdx)("p",null,"Note that if you specify your own value for this config option it will replace (not concatenate with) Metro's default."),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"[/(^|\\/|\\\\)node_modules($|\\/|\\\\)/]"),"."),(0,r.mdx)("h4",{id:"unstable_conditionnames-experimental"},(0,r.mdx)("inlineCode",{parentName:"h4"},"unstable_conditionNames")," ",(0,r.mdx)("div",{class:"label experimental"},"Experimental")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This setting will take effect when ",(0,r.mdx)("a",{parentName:"p",href:"#unstable_enablepackageexports-experimental"},(0,r.mdx)("inlineCode",{parentName:"a"},"unstable_enablePackageExports")),"  is ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),". It may not behave as described while this feature is experimental.")),(0,r.mdx)("p",null,"The set of ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#conditional-exports"},"condition names")," to assert globally when interpreting the ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#exports"},(0,r.mdx)("inlineCode",{parentName:"a"},'"exports"')," field")," in package.json."),(0,r.mdx)("p",null,"Conditions may be any string value and are resolved in the order specified by each package. Node.js documents a number of ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#community-conditions-definitions"},"community conditions")," which are commonly used by package authors. The ",(0,r.mdx)("inlineCode",{parentName:"p"},"default")," condition is always matched."),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['require']"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"When using React Native, ",(0,r.mdx)("inlineCode",{parentName:"p"},"unstable_conditionNames")," defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['require', 'react-native']"),".")),(0,r.mdx)("h4",{id:"unstable_conditionsbyplatform-experimental"},(0,r.mdx)("inlineCode",{parentName:"h4"},"unstable_conditionsByPlatform")," ",(0,r.mdx)("div",{class:"label experimental"},"Experimental")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"{[platform: string]: Array<string>}")),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This setting will take effect when ",(0,r.mdx)("a",{parentName:"p",href:"#unstable_enablepackageexports-experimental"},(0,r.mdx)("inlineCode",{parentName:"a"},"unstable_enablePackageExports")),"  is ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),". It may not behave as described while this feature is experimental.")),(0,r.mdx)("p",null,"The set of additional ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#conditional-exports"},"condition names")," to dynamically assert by platform (see ",(0,r.mdx)("a",{parentName:"p",href:"#platforms"},(0,r.mdx)("inlineCode",{parentName:"a"},"platforms")),") when interpreting the ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#exports"},(0,r.mdx)("inlineCode",{parentName:"a"},'"exports"')," field")," in package.json."),(0,r.mdx)("p",null,"Matched conditions are merged with ",(0,r.mdx)("a",{parentName:"p",href:"#unstable-conditionnames"},(0,r.mdx)("inlineCode",{parentName:"a"},"unstable_conditionNames"))," before resolution. With the defaults for both options, the conditions ",(0,r.mdx)("inlineCode",{parentName:"p"},"new Set(['require', 'browser'])")," will be asserted when requesting a ",(0,r.mdx)("inlineCode",{parentName:"p"},"web")," bundle, and ",(0,r.mdx)("inlineCode",{parentName:"p"},"new Set(['require'])")," otherwise. Again, these are resolved in the order specified by each package."),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"\u200c{ web: ['browser'] }"),"."),(0,r.mdx)("h4",{id:"unstable_enablepackageexports-experimental"},(0,r.mdx)("inlineCode",{parentName:"h4"},"unstable_enablePackageExports")," ",(0,r.mdx)("div",{class:"label experimental"},"Experimental")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Enable experimental ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#package-entry-points"},"Package Exports")," support. Under this mode, Metro will read the ",(0,r.mdx)("a",{parentName:"p",href:"https://nodejs.org/docs/latest-v18.x/api/packages.html#exports"},(0,r.mdx)("inlineCode",{parentName:"a"},'"exports"')," field")," in ",(0,r.mdx)("inlineCode",{parentName:"p"},"package.json")," files when present and use it to resolve package entry points."),(0,r.mdx)("p",null,"When no match is found in ",(0,r.mdx)("inlineCode",{parentName:"p"},'"exports"'),", Metro will log a warning and fall back to resolving modules without considering ",(0,r.mdx)("inlineCode",{parentName:"p"},'"exports"'),". This makes this mode largely backwards-compatible, with the following exceptions:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"If a module is matched in ",(0,r.mdx)("inlineCode",{parentName:"li"},'"exports"'),", ",(0,r.mdx)("a",{parentName:"li",href:"#sourceexts"},(0,r.mdx)("inlineCode",{parentName:"a"},"sourceExts"))," and ",(0,r.mdx)("a",{parentName:"li",href:"#platforms"},(0,r.mdx)("inlineCode",{parentName:"a"},"platforms"))," will not be considered (i.e. platform-specific extensions will not be used). This is done for compatibility with Node."),(0,r.mdx)("li",{parentName:"ul"},"If a module exists at a file path that is also listed in ",(0,r.mdx)("inlineCode",{parentName:"li"},'"exports"'),", and the ",(0,r.mdx)("inlineCode",{parentName:"li"},'"exports"')," entry maps to a different file, the ",(0,r.mdx)("inlineCode",{parentName:"li"},'"exports"')," entry will be preferred.")),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"In a future release of Metro, this option will become ",(0,r.mdx)("inlineCode",{parentName:"p"},"true")," by default.")),(0,r.mdx)("hr",null),(0,r.mdx)("h3",{id:"transformer-options"},"Transformer Options"),(0,r.mdx)("a",{name:"asyncrequiremodulepath"}),(0,r.mdx)("h4",{id:"asyncrequiremodulepath-deprecated"},(0,r.mdx)("inlineCode",{parentName:"h4"},"asyncRequireModulePath")," ",(0,r.mdx)("div",{class:"label deprecated"},"Deprecated")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"The name of a module that provides the ",(0,r.mdx)("inlineCode",{parentName:"p"},"asyncRequire")," function, which is used to implement ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import"},"dynamic ",(0,r.mdx)("inlineCode",{parentName:"a"},"import()"))," at runtime. Defaults to ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro-runtime/src/modules/asyncRequire.js"},(0,r.mdx)("inlineCode",{parentName:"a"},"metro-runtime/src/modules/asyncRequire")),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"The module named by ",(0,r.mdx)("inlineCode",{parentName:"p"},"asyncRequireModulePath")," is ",(0,r.mdx)("a",{parentName:"p",href:"/docs/resolution"},"resolved")," relative to the module containing the original ",(0,r.mdx)("inlineCode",{parentName:"p"},"import()")," call. In particular, assuming the default value of ",(0,r.mdx)("inlineCode",{parentName:"p"},"asyncRequireModulePath")," is in use, the project must have a compatible version of ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro-runtime")," installed in ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules"),".")),(0,r.mdx)("admonition",{type:"info"},(0,r.mdx)("p",{parentName:"admonition"},"In older versions of Metro, a custom ",(0,r.mdx)("inlineCode",{parentName:"p"},"asyncRequireModulePath")," could be used as part of a bundle splitting solution. This usage is now deprecated in favor of the ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/react-native-community/discussions-and-proposals/blob/main/proposals/0605-lazy-bundling.md#__loadbundleasync-in-metro"},(0,r.mdx)("inlineCode",{parentName:"a"},"__loadBundleAsync"))," API.")),(0,r.mdx)("h4",{id:"dynamicdepsinpackages"},(0,r.mdx)("inlineCode",{parentName:"h4"},"dynamicDepsInPackages")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"'throwAtRuntime' | 'reject'")),(0,r.mdx)("p",null,"Controls how Metro handles dependencies that cannot be statically analyzed at build time. For example, ",(0,r.mdx)("inlineCode",{parentName:"p"},"require('./' + someFunction() + '.js')")," cannot be resolved without knowing what ",(0,r.mdx)("inlineCode",{parentName:"p"},"someFunction()")," will return."),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"'throwAtRuntime'"))," (the default): Metro does not stop bundling, but the ",(0,r.mdx)("inlineCode",{parentName:"li"},"require")," call will throw at runtime."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"'reject'")),": Metro will stop bundling and report an error to the user.")),(0,r.mdx)("h4",{id:"gettransformoptions"},(0,r.mdx)("inlineCode",{parentName:"h4"},"getTransformOptions")),(0,r.mdx)("p",null,"Type: Function (see details below)"),(0,r.mdx)("p",null,"A function called by Metro to calculate additional options for the transformer and serializer based on the specific bundle being built."),(0,r.mdx)("p",null,"Metro expects ",(0,r.mdx)("inlineCode",{parentName:"p"},"getTransformOptions")," to have the following signature:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-flow"},"function getTransformOptions(\n  entryPoints: $ReadOnlyArray<string>,\n  options: {\n    dev: boolean,\n    hot: boolean,\n    platform: ?string,\n  },\n  getDependenciesOf: (path: string) => Promise<Array<string>>,\n): Promise<ExtraTransformOptions> {\n  // ...\n}\n")),(0,r.mdx)("p",null,(0,r.mdx)("inlineCode",{parentName:"p"},"getTransformOptions")," receives these parameters:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"entryPoints")),": Absolute paths to the bundle's entry points (typically just one)."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"options")),":",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"dev")),": Whether the bundle is being built in development mode."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"hot")),": ",(0,r.mdx)("div",{class:"label deprecated"},"Deprecated")," Always true."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"platform")),": The target platform (e.g. ",(0,r.mdx)("inlineCode",{parentName:"li"},"ios"),", ",(0,r.mdx)("inlineCode",{parentName:"li"},"android"),")."))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"getDependenciesOf")),": A function which, given an absolute path to a module, returns a promise that resolves to the absolute paths of the module's transitive dependencies.")),(0,r.mdx)("p",null,(0,r.mdx)("inlineCode",{parentName:"p"},"getTransformOptions")," should return a promise that resolves to an object with the following properties:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-flow"},"type ExtraTransformOptions = {\n  preloadedModules?: {[path: string]: true} | false,\n  ramGroups?: Array<string>,\n  transform?: {\n    inlineRequires?: {blockList: {[string]: true}} | boolean,\n    nonInlinedRequires?: $ReadOnlyArray<string>,\n  },\n};\n")),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"preloadedModules")),": A plain object whose keys represent a set of absolute paths. When serializing an ",(0,r.mdx)("a",{parentName:"li",href:"https://reactnative.dev/docs/ram-bundles-inline-requires#enable-the-ram-format"},"indexed RAM bundle"),", the modules in this set will be marked for eager evaluation at runtime."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"ramGroups")),": An array of absolute paths. When serializing an ",(0,r.mdx)("a",{parentName:"li",href:"https://reactnative.dev/docs/ram-bundles-inline-requires#enable-the-ram-format"},"indexed RAM bundle"),", each of the listed modules will be serialized along with its transitive dependencies. At runtime, the modules will all be parsed together as soon as any one of them is evaluated."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"transform")),": Advanced options for the transformer.",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"inlineRequires")),":",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},"If ",(0,r.mdx)("inlineCode",{parentName:"li"},"inlineRequires")," is a boolean, it controls whether ",(0,r.mdx)("a",{parentName:"li",href:"https://reactnative.dev/docs/ram-bundles-inline-requires#inline-requires"},"inline requires")," are enabled in this bundle."),(0,r.mdx)("li",{parentName:"ul"},"If ",(0,r.mdx)("inlineCode",{parentName:"li"},"inlineRequires")," is an object, inline requires are enabled in all modules, except ones whose absolute paths appear as keys of ",(0,r.mdx)("inlineCode",{parentName:"li"},"inlineRequires.blockList"),"."))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},(0,r.mdx)("inlineCode",{parentName:"strong"},"nonInlinedRequires")),": An array of unresolved module specifiers (e.g. ",(0,r.mdx)("inlineCode",{parentName:"li"},"react"),", ",(0,r.mdx)("inlineCode",{parentName:"li"},"react-native"),") to never inline, even when inline requires are enabled.")))),(0,r.mdx)("h4",{id:"minifierpath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"minifierPath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")," (default: ",(0,r.mdx)("inlineCode",{parentName:"p"},"'metro-minify-terser'"),")"),(0,r.mdx)("p",null,"Path, or package name resolvable from ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro-transform-worker"),", to the minifier that minifies the code after transformation."),(0,r.mdx)("h4",{id:"minifierconfig"},(0,r.mdx)("inlineCode",{parentName:"h4"},"minifierConfig")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"{[key: string]: mixed}")),(0,r.mdx)("p",null,"Configuration object that will be passed to the minifier (it should be serializable)."),(0,r.mdx)("h4",{id:"optimizationsizelimit"},(0,r.mdx)("inlineCode",{parentName:"h4"},"optimizationSizeLimit")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"number")),(0,r.mdx)("p",null,"Define a threshold (in bytes) to disable some expensive optimizations for big files."),(0,r.mdx)("h4",{id:"react-native-only"},"React Native Only"),(0,r.mdx)("h4",{id:"assetplugins"},(0,r.mdx)("inlineCode",{parentName:"h4"},"assetPlugins")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"List of modules to call to modify Asset data"),(0,r.mdx)("h4",{id:"assetregistrypath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"assetRegistryPath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"Where to fetch the assets from."),(0,r.mdx)("h3",{id:"babel-specific-transformer-options"},"Babel-specific transformer options"),(0,r.mdx)("h4",{id:"babeltransformerpath"},(0,r.mdx)("inlineCode",{parentName:"h4"},"babelTransformerPath")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"The name of a module that compiles code with Babel, returning an AST and optional metadata. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro-babel-transformer"),"."),(0,r.mdx)("p",null,"Refer to the source code of ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/main/packages/metro-babel-transformer/src/index.js"},(0,r.mdx)("inlineCode",{parentName:"a"},"metro-babel-transformer"))," and ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/react-native/blob/main/packages/react-native-babel-transformer/src/index.js"},(0,r.mdx)("inlineCode",{parentName:"a"},"@react-native/metro-babel-transformer"))," for details on implementing a custom Babel transformer."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This option only has an effect under the default ",(0,r.mdx)("a",{parentName:"p",href:"#transformerpath"},(0,r.mdx)("inlineCode",{parentName:"a"},"transformerPath")),". Custom transformers may ignore it.")),(0,r.mdx)("h4",{id:"enablebabelrclookup"},(0,r.mdx)("inlineCode",{parentName:"h4"},"enableBabelRCLookup")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Whether to enable searching for Babel configuration files. This is passed to Babel as the ",(0,r.mdx)("a",{parentName:"p",href:"https://babeljs.io/docs/en/options#babelrc"},(0,r.mdx)("inlineCode",{parentName:"a"},"babelrc"))," config option. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This option only has an effect under the default ",(0,r.mdx)("a",{parentName:"p",href:"#transformerpath"},(0,r.mdx)("inlineCode",{parentName:"a"},"transformerPath")),". Custom transformers may ignore it. Custom ",(0,r.mdx)("a",{parentName:"p",href:"#babeltransformerpath"},"Babel transformers")," should respect this option.")),(0,r.mdx)("h4",{id:"enablebabelruntime"},(0,r.mdx)("inlineCode",{parentName:"h4"},"enableBabelRuntime")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean | string")),(0,r.mdx)("p",null,"Whether the transformer should use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"@babel/transform/runtime")," plugin. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),"."),(0,r.mdx)("p",null,"If the value is a string, it is treated as a runtime version number and passed as ",(0,r.mdx)("inlineCode",{parentName:"p"},"version")," to the ",(0,r.mdx)("inlineCode",{parentName:"p"},"@babel/plugin-transform-runtime")," configuration. This allows you to optimize the generated Babel runtime calls based on the version installed in your project."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This option only works under the default settings for React Native. It may have no effect in a project that uses custom ",(0,r.mdx)("a",{parentName:"p",href:"#transformerpath"},(0,r.mdx)("inlineCode",{parentName:"a"},"transformerPath")),", a custom ",(0,r.mdx)("a",{parentName:"p",href:"#babeltransformerpath"},(0,r.mdx)("inlineCode",{parentName:"a"},"babelTransformerPath"))," or a custom ",(0,r.mdx)("a",{parentName:"p",href:"https://babeljs.io/docs/en/config-files"},"Babel config file"),".")),(0,r.mdx)("h4",{id:"hermesparser"},(0,r.mdx)("inlineCode",{parentName:"h4"},"hermesParser")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Whether to use the ",(0,r.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/hermes-parser"},(0,r.mdx)("inlineCode",{parentName:"a"},"hermes-parser"))," package to parse JavaScript source files, instead of Babel. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"This option only has an effect under the default ",(0,r.mdx)("a",{parentName:"p",href:"#transformerpath"},(0,r.mdx)("inlineCode",{parentName:"a"},"transformerPath"))," and the ",(0,r.mdx)("a",{parentName:"p",href:"#babeltransformerpath"},"Babel transformers")," built into Metro. Custom transformers and custom ",(0,r.mdx)("a",{parentName:"p",href:"#babeltransformerpath"},"Babel transformers")," may ignore it.")),(0,r.mdx)("hr",null),(0,r.mdx)("h3",{id:"serializer-options"},"Serializer Options"),(0,r.mdx)("h4",{id:"getrunmodulestatement"},(0,r.mdx)("inlineCode",{parentName:"h4"},"getRunModuleStatement")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"(number | string) => string")),(0,r.mdx)("p",null,"Specify the format of the initial require statements that are appended at the end of the bundle. By default is ",(0,r.mdx)("inlineCode",{parentName:"p"},"__r(${moduleId});"),"."),(0,r.mdx)("h4",{id:"createmoduleidfactory"},(0,r.mdx)("inlineCode",{parentName:"h4"},"createModuleIdFactory")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"() => (path: string) => number")),(0,r.mdx)("p",null,"Used to generate the module id for ",(0,r.mdx)("inlineCode",{parentName:"p"},"require")," statements."),(0,r.mdx)("h4",{id:"getpolyfills"},(0,r.mdx)("inlineCode",{parentName:"h4"},"getPolyfills")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"({platform: ?string}) => $ReadOnlyArray<string>")),(0,r.mdx)("p",null,"An optional list of polyfills to include in the bundle. The list defaults to a set of common polyfills for Number, String, Array, Object..."),(0,r.mdx)("h4",{id:"getmodulesrunbeforemainmodule"},(0,r.mdx)("inlineCode",{parentName:"h4"},"getModulesRunBeforeMainModule")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"(entryFilePath: string) => Array<string>")),(0,r.mdx)("p",null,"An array of modules to be required before the entry point. It should contain the absolute path of each module. Note that this will add the additional require statements only if the passed modules are already included as part of the bundle."),(0,r.mdx)("h4",{id:"processmodulefilter"},(0,r.mdx)("inlineCode",{parentName:"h4"},"processModuleFilter")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"(module: Array<Module>) => boolean")),(0,r.mdx)("p",null,"A filter function to discard specific modules from the output."),(0,r.mdx)("h4",{id:"isthirdpartymodule"},(0,r.mdx)("inlineCode",{parentName:"h4"},"isThirdPartyModule")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"(module: {path: string, ...}) => boolean")),(0,r.mdx)("p",null,"A function that determines which modules are added to the ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.chrome.com/articles/x-google-ignore-list/"},(0,r.mdx)("inlineCode",{parentName:"a"},"x_google_ignoreList"))," field of the source map. This supports ",(0,r.mdx)("a",{parentName:"p",href:"https://developer.chrome.com/blog/devtools-modern-web-debugging/#just-my-code"},'"Just My Code"')," debugging in Chrome DevTools and other compatible debuggers."),(0,r.mdx)("p",null,"Defaults to returning ",(0,r.mdx)("inlineCode",{parentName:"p"},"true")," for modules with a path component named ",(0,r.mdx)("inlineCode",{parentName:"p"},"node_modules"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"In addition to modules marked as ignored by ",(0,r.mdx)("inlineCode",{parentName:"p"},"isThirdPartyModule"),", Metro will also automatically add modules generated by the bundler itself to the ignore list.")),(0,r.mdx)("hr",null),(0,r.mdx)("h3",{id:"server-options"},"Server Options"),(0,r.mdx)("p",null,"These options are used when Metro serves the content."),(0,r.mdx)("h4",{id:"port"},(0,r.mdx)("inlineCode",{parentName:"h4"},"port")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"number")),(0,r.mdx)("p",null,"Which port to listen on."),(0,r.mdx)("h4",{id:"useglobalhotkey"},(0,r.mdx)("inlineCode",{parentName:"h4"},"useGlobalHotkey")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Whether we should enable CMD+R hotkey for refreshing the bundle."),(0,r.mdx)("h4",{id:"enhancemiddleware-deprecated"},(0,r.mdx)("inlineCode",{parentName:"h4"},"enhanceMiddleware")," ",(0,r.mdx)("div",{class:"label deprecated"},"Deprecated")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"(Middleware, MetroServer) => Middleware")),(0,r.mdx)("p",null,"A function that allows attaching custom ",(0,r.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/connect"},(0,r.mdx)("inlineCode",{parentName:"a"},"connect"))," middleware to Metro. For example:"),(0,r.mdx)("admonition",{type:"tip"},(0,r.mdx)("p",{parentName:"admonition"},"You can use ",(0,r.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/connect#mount-middleware"},(0,r.mdx)("inlineCode",{parentName:"a"},"connect()"))," as a utility to extend the base ",(0,r.mdx)("inlineCode",{parentName:"p"},"metroMiddleware")," and to mount additional middleware handlers.")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-ts"},"enhanceMiddleware: (metroMiddleware: Middleware, metroServer: MetroServer) => {\n  return connect()\n    .use(metroMiddleware)\n    .use('/custom-endpoint', customEndpointMiddleware());\n},\n")),(0,r.mdx)("p",null,"The ",(0,r.mdx)("inlineCode",{parentName:"p"},"Middleware")," type is an alias for ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/DefinitelyTyped/DefinitelyTyped/blob/876b9ec96ba02d0c84b1e49af5890c8f5aa2dfe3/types/connect/index.d.ts#L29"},(0,r.mdx)("inlineCode",{parentName:"a"},"connect.HandleFunction")),"."),(0,r.mdx)("h4",{id:"rewriterequesturl"},(0,r.mdx)("inlineCode",{parentName:"h4"},"rewriteRequestUrl")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string => string")),(0,r.mdx)("p",null,"A function that will be called every time Metro processes a URL, after normalization of non-standard query-string delimiters using ",(0,r.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/jsc-safe-url"},(0,r.mdx)("inlineCode",{parentName:"a"},"jsc-safe-url")),". Metro will use the return value of this function as if it were the original URL provided by the client. This applies to all incoming HTTP requests (after any custom middleware), as well as bundle URLs in ",(0,r.mdx)("inlineCode",{parentName:"p"},"/symbolicate")," request payloads and within the hot reloading protocol."),(0,r.mdx)("h4",{id:"forwardclientlogs"},(0,r.mdx)("inlineCode",{parentName:"h4"},"forwardClientLogs")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Enable forwarding of ",(0,r.mdx)("inlineCode",{parentName:"p"},"client_log")," events (when client logs are ",(0,r.mdx)("a",{parentName:"p",href:"https://github.com/facebook/metro/blob/614ad14a85b22958129ee94e04376b096f03ccb1/packages/metro/src/lib/createWebsocketServer.js#L20"},"configured"),") to the reporter. Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"true"),"."),(0,r.mdx)("hr",null),(0,r.mdx)("h3",{id:"watcher-options"},"Watcher Options"),(0,r.mdx)("p",null,"Options for the filesystem watcher."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"Dot notation in this section indicates a nested configuration object, e.g. ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchman.deferStates")," \u2192 ",(0,r.mdx)("inlineCode",{parentName:"p"},"watchman: { deferStates: ... }"),".")),(0,r.mdx)("h4",{id:"additionalexts"},(0,r.mdx)("inlineCode",{parentName:"h4"},"additionalExts")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"The extensions which Metro should watch in addition to ",(0,r.mdx)("inlineCode",{parentName:"p"},"sourceExts"),", but which will not be automatically tried by the resolver."),(0,r.mdx)("p",null,"Therefore, the two behavior differences from ",(0,r.mdx)("inlineCode",{parentName:"p"},"resolver.sourceExts")," when importing a module are:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Modules can only be required when fully specified (e.g. ",(0,r.mdx)("inlineCode",{parentName:"li"},"import moduleA from 'moduleA.mjs'"),")."),(0,r.mdx)("li",{parentName:"ul"},"No platform-specific resolution is performed.")),(0,r.mdx)("p",null,"Defaults to ",(0,r.mdx)("inlineCode",{parentName:"p"},"['cjs', 'mjs']"),"."),(0,r.mdx)("h4",{id:"healthcheckenabled"},(0,r.mdx)("inlineCode",{parentName:"h4"},"healthCheck.enabled")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"boolean")),(0,r.mdx)("p",null,"Whether to periodically check the health of the filesystem watcher by writing a temporary file to the project and waiting for it to be observed."),(0,r.mdx)("p",null,"The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"false"),"."),(0,r.mdx)("h4",{id:"healthcheckfileprefix"},(0,r.mdx)("inlineCode",{parentName:"h4"},"healthCheck.filePrefix")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"string")),(0,r.mdx)("p",null,"If watcher health checks are enabled, this property controls the name of the temporary file that will be written into the project filesystem."),(0,r.mdx)("p",null,"The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"'.metro-health-check'"),"."),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"There's no need to commit health check files to source control. If you choose to enable health checks in your project, make sure you add ",(0,r.mdx)("inlineCode",{parentName:"p"},".metro-health-check*")," to your ",(0,r.mdx)("inlineCode",{parentName:"p"},".gitignore")," file to avoid generating unnecessary changes.")),(0,r.mdx)("h4",{id:"healthcheckinterval"},(0,r.mdx)("inlineCode",{parentName:"h4"},"healthCheck.interval")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"number")),(0,r.mdx)("p",null,"If watcher health checks are enabled, this property controls how often they occur (in milliseconds)."),(0,r.mdx)("p",null,"The default value is 30000."),(0,r.mdx)("h4",{id:"healthchecktimeout"},(0,r.mdx)("inlineCode",{parentName:"h4"},"healthCheck.timeout")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"number")),(0,r.mdx)("p",null,"If watcher health checks are enabled, this property controls the time (in milliseconds) Metro will wait for a file change to be observed before considering the check to have failed."),(0,r.mdx)("p",null,"The default value is 5000."),(0,r.mdx)("h4",{id:"watchmandeferstates"},(0,r.mdx)("inlineCode",{parentName:"h4"},"watchman.deferStates")),(0,r.mdx)("p",null,"Type: ",(0,r.mdx)("inlineCode",{parentName:"p"},"Array<string>")),(0,r.mdx)("p",null,"Applies when using Watchman. Metro will ",(0,r.mdx)("a",{parentName:"p",href:"https://facebook.github.io/watchman/docs/cmd/subscribe.html#defer"},"defer processing filesystem updates")," while these ",(0,r.mdx)("a",{parentName:"p",href:"https://facebook.github.io/watchman/docs/cmd/state-enter.html"},"states")," are asserted in the watch. This is useful for debouncing builds while the filesystem hasn't settled, e.g. during large source control operations."),(0,r.mdx)("p",null,"The default value is ",(0,r.mdx)("inlineCode",{parentName:"p"},"['hg.update']"),"."),(0,r.mdx)("h2",{id:"merging-configurations"},"Merging Configurations"),(0,r.mdx)("p",null,"Using the ",(0,r.mdx)("inlineCode",{parentName:"p"},"metro-config")," package it is possible to merge multiple configurations together."),(0,r.mdx)("table",null,(0,r.mdx)("thead",{parentName:"table"},(0,r.mdx)("tr",{parentName:"thead"},(0,r.mdx)("th",{parentName:"tr",align:null},"Method"),(0,r.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,r.mdx)("tbody",{parentName:"table"},(0,r.mdx)("tr",{parentName:"tbody"},(0,r.mdx)("td",{parentName:"tr",align:null},(0,r.mdx)("inlineCode",{parentName:"td"},"mergeConfig(...configs): MergedConfig")),(0,r.mdx)("td",{parentName:"tr",align:null},"Returns the merged configuration of two or more configuration objects.")))),(0,r.mdx)("admonition",{type:"note"},(0,r.mdx)("p",{parentName:"admonition"},"Arrays and function based config parameters do not deeply merge and will instead override any pre-existing config parameters.\nThis allows overriding and removing default config parameters such as ",(0,r.mdx)("inlineCode",{parentName:"p"},"platforms")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"getModulesRunBeforeMainModule")," that may not be required in your environment.")),(0,r.mdx)("h4",{id:"merging-example"},"Merging Example"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-js"},"// metro.config.js\nconst { mergeConfig } = require('metro-config');\n\nconst configA = {\n  /* general options */\n\n  resolver: {\n    /* resolver options */\n  },\n  transformer: {\n    /* transformer options */\n  },\n  serializer: {\n    /* serializer options */\n  },\n  server: {\n    /* server options */\n  }\n};\n\nconst configB = {\n  /* general options */\n\n  resolver: {\n    /* resolver options */\n  },\n  transformer: {\n    /* transformer options */\n  },\n  serializer: {\n    /* serializer options */\n  },\n  server: {\n    /* server options */\n  }\n};\n\nmodule.exports = mergeConfig(configA, configB);\n")))}h.isMDXComponent=!0}}]);